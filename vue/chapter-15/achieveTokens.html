<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>火箭吧！</title>
    <meta name="description" content="越记录，越美好！">
    <meta name="generator" content="VitePress v1.3.1">
    <link rel="preload stylesheet" href="/record-moments/assets/style.j080JL7J.css" as="style">
    <script type="module" src="/record-moments/assets/chunks/metadata.47be7af2.js"></script>
    <script type="module" src="/record-moments/assets/app.CPVhGLHT.js"></script>
    <link rel="preload" href="/record-moments/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/record-moments/assets/chunks/framework.DoOQMVQs.js">
    <link rel="modulepreload" href="/record-moments/assets/chunks/theme.C3lc9r11.js">
    <link rel="modulepreload" href="/record-moments/assets/vue_chapter-15_achieveTokens.md.sZvqTYrD.lean.js">
    <link rel="icon" type="image/svg+xml" href="/record-moments/img/vitepress-logo-mini.svg">
    <link rel="icon" type="image/png" href="/record-moments/img/vitepress-logo-mini.png">
    <link rel="mask-icon" color="#3eaf7c" href="/record-moments/img/vitepress-logo.svg">
    <link rel="apple-touch-icon" href="/record-moments/img/vitepress-logo.png">
    <meta name="theme-color" content="#3eaf7c">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="en">
    <meta property="og:title" content="火箭吧 | 一个记录美好生活的网站">
    <meta property="og:site_name" content="火箭吧">
    <meta property="og:image" content="https://vitepress.dev/vitepress-og.jpg">
    <meta property="og:url" content="https://vitepress.dev/">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-02aa45e7><!--[--><!--]--><!--[--><span tabindex="-1" data-v-22dc1176></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-22dc1176> Skip to content </a><!--]--><!----><header class="VPNav" data-v-02aa45e7 data-v-08088af9><div class="VPNavBar has-sidebar top" data-v-08088af9 data-v-bf18cc39><div class="wrapper" data-v-bf18cc39><div class="container" data-v-bf18cc39><div class="title" data-v-bf18cc39><div class="VPNavBarTitle has-sidebar" data-v-bf18cc39 data-v-4af299d3><a class="title" href="/record-moments/" data-v-4af299d3><!--[--><!--]--><!--[--><img class="VPImage logo" src="/record-moments/img/vitepress-logo-mini.svg" alt data-v-a00ecfd1><!--]--><span data-v-4af299d3>火箭吧！</span><!--[--><!--]--></a></div></div><div class="content" data-v-bf18cc39><div class="content-body" data-v-bf18cc39><!--[--><!--]--><div class="VPNavBarSearch search" data-v-bf18cc39><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-bf18cc39 data-v-5a389bf2><span id="main-nav-aria-label" class="visually-hidden" data-v-5a389bf2> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/record-moments/guide/husky" tabindex="0" data-v-5a389bf2 data-v-125de55a><!--[--><span data-v-125de55a>指南</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/record-moments/vue/chapter-4/proxyAchieve" tabindex="0" data-v-5a389bf2 data-v-125de55a><!--[--><span data-v-125de55a>VUE原理</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-bf18cc39 data-v-f4381c31><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="切换到深色模式" aria-checked="false" data-v-f4381c31 data-v-a5dad3f8 data-v-837a189c><span class="check" data-v-837a189c><span class="icon" data-v-837a189c><!--[--><span class="vpi-sun sun" data-v-a5dad3f8></span><span class="vpi-moon moon" data-v-a5dad3f8></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-bf18cc39 data-v-84bfe90d data-v-ee026d42><!--[--><a class="VPSocialLink no-icon" href="https://github.com/zxn2889/record-moments" aria-label="github" target="_blank" rel="noopener" data-v-ee026d42 data-v-94a69745><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-bf18cc39 data-v-b39062ce data-v-6f769cae><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-6f769cae><span class="vpi-more-horizontal icon" data-v-6f769cae></span></button><div class="menu" data-v-6f769cae><div class="VPMenu" data-v-6f769cae data-v-ac7801f7><!----><!--[--><!--[--><!----><div class="group" data-v-b39062ce><div class="item appearance" data-v-b39062ce><p class="label" data-v-b39062ce>主题</p><div class="appearance-action" data-v-b39062ce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="切换到深色模式" aria-checked="false" data-v-b39062ce data-v-a5dad3f8 data-v-837a189c><span class="check" data-v-837a189c><span class="icon" data-v-837a189c><!--[--><span class="vpi-sun sun" data-v-a5dad3f8></span><span class="vpi-moon moon" data-v-a5dad3f8></span><!--]--></span></span></button></div></div></div><div class="group" data-v-b39062ce><div class="item social-links" data-v-b39062ce><div class="VPSocialLinks social-links-list" data-v-b39062ce data-v-ee026d42><!--[--><a class="VPSocialLink no-icon" href="https://github.com/zxn2889/record-moments" aria-label="github" target="_blank" rel="noopener" data-v-ee026d42 data-v-94a69745><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-bf18cc39 data-v-63227861><span class="container" data-v-63227861><span class="top" data-v-63227861></span><span class="middle" data-v-63227861></span><span class="bottom" data-v-63227861></span></span></button></div></div></div></div><div class="divider" data-v-bf18cc39><div class="divider-line" data-v-bf18cc39></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-02aa45e7 data-v-ef70e8c8><div class="container" data-v-ef70e8c8><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-ef70e8c8><span class="vpi-align-left menu-icon" data-v-ef70e8c8></span><span class="menu-text" data-v-ef70e8c8>菜单</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-ef70e8c8 data-v-40735804><button data-v-40735804>回到顶部</button><!----></div></div></div><aside class="VPSidebar" data-v-02aa45e7 data-v-f17ec55f><div class="curtain" data-v-f17ec55f></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-f17ec55f><span class="visually-hidden" id="sidebar-aria-label" data-v-f17ec55f> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-a9203bc9><section class="VPSidebarItem level-0 collapsible" data-v-a9203bc9 data-v-6c04240e><div class="item" role="button" tabindex="0" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><h2 class="text" data-v-6c04240e>第四章</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6c04240e><span class="vpi-chevron-right caret-icon" data-v-6c04240e></span></div></div><div class="items" data-v-6c04240e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-4/proxyAchieve" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>响应式实现过程</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-4/effectNest" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>effect嵌套实现过程</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-4/solvingInfiniteRecursion" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>避免无限递归</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-4/schedulingExecution" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>调度执行</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-4/achieveComputed" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>实现 computed</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-4/achieveWatch" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>实现 watch</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-4/achieveWatchSomeOptions" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>实现 watch 函数的立即执行与回调的调度执行</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-4/expiredSideEffects" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>过期的副作用</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a9203bc9><section class="VPSidebarItem level-0 collapsible" data-v-a9203bc9 data-v-6c04240e><div class="item" role="button" tabindex="0" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><h2 class="text" data-v-6c04240e>第五章</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6c04240e><span class="vpi-chevron-right caret-icon" data-v-6c04240e></span></div></div><div class="items" data-v-6c04240e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-5/furtherAgency" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>更近一步的 Proxy</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-5/reasonableTriggeringResponse" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>合理的触发响应</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-5/shallowOrDeepResponse" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>浅响应与深响应</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-5/shallowOrDeepReadOnly" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>只读与浅只读</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-5/achieveArrayProxy" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>数组的代理</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a9203bc9><section class="VPSidebarItem level-0 collapsible" data-v-a9203bc9 data-v-6c04240e><div class="item" role="button" tabindex="0" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><h2 class="text" data-v-6c04240e>第六章</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6c04240e><span class="vpi-chevron-right caret-icon" data-v-6c04240e></span></div></div><div class="items" data-v-6c04240e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-6/achieveOriganValueProxy" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>原始值的响应方案</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a9203bc9><section class="VPSidebarItem level-0 collapsible" data-v-a9203bc9 data-v-6c04240e><div class="item" role="button" tabindex="0" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><h2 class="text" data-v-6c04240e>第七章</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6c04240e><span class="vpi-chevron-right caret-icon" data-v-6c04240e></span></div></div><div class="items" data-v-6c04240e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-7/designRenderer" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>渲染器的设计</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a9203bc9><section class="VPSidebarItem level-0 collapsible" data-v-a9203bc9 data-v-6c04240e><div class="item" role="button" tabindex="0" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><h2 class="text" data-v-6c04240e>第八章</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6c04240e><span class="vpi-chevron-right caret-icon" data-v-6c04240e></span></div></div><div class="items" data-v-6c04240e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-8/mountChildVnodeAndProps" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>子节点和 props 属性的挂载</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-8/unmountVnode" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>卸载节点的几种情况</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-8/mountEvent" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>如何挂载事件</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-8/updateChildVnode" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>更新子节点</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-8/vnodeTypes" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>认识其他的 vnode 类型</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a9203bc9><section class="VPSidebarItem level-0 collapsible" data-v-a9203bc9 data-v-6c04240e><div class="item" role="button" tabindex="0" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><h2 class="text" data-v-6c04240e>第九章</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6c04240e><span class="vpi-chevron-right caret-icon" data-v-6c04240e></span></div></div><div class="items" data-v-6c04240e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-9/firstMeetDiff" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>初识 diff</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a9203bc9><section class="VPSidebarItem level-0 collapsible" data-v-a9203bc9 data-v-6c04240e><div class="item" role="button" tabindex="0" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><h2 class="text" data-v-6c04240e>第十章</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6c04240e><span class="vpi-chevron-right caret-icon" data-v-6c04240e></span></div></div><div class="items" data-v-6c04240e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-10/doubleEndDiff" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>双端比较 diff</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a9203bc9><section class="VPSidebarItem level-0 collapsible" data-v-a9203bc9 data-v-6c04240e><div class="item" role="button" tabindex="0" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><h2 class="text" data-v-6c04240e>第十一章</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6c04240e><span class="vpi-chevron-right caret-icon" data-v-6c04240e></span></div></div><div class="items" data-v-6c04240e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-11/quickDiff" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>快速 diff</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a9203bc9><section class="VPSidebarItem level-0 collapsible" data-v-a9203bc9 data-v-6c04240e><div class="item" role="button" tabindex="0" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><h2 class="text" data-v-6c04240e>第十二章</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6c04240e><span class="vpi-chevron-right caret-icon" data-v-6c04240e></span></div></div><div class="items" data-v-6c04240e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-12/achieveAssemblyMountedAndUpdate" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>组件的挂载与更新</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-12/achieveAssemblySetup" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>实现 setup</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-12/achieveAssemblyEmit" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>实现 emit</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-12/achieveAssemblySlots" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>实现 slots</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-12/achieveAssemblyMounted" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>实现生命周期</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a9203bc9><section class="VPSidebarItem level-0 collapsible" data-v-a9203bc9 data-v-6c04240e><div class="item" role="button" tabindex="0" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><h2 class="text" data-v-6c04240e>第十三章</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6c04240e><span class="vpi-chevron-right caret-icon" data-v-6c04240e></span></div></div><div class="items" data-v-6c04240e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-13/achieveAssemblyFun" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>函数式组件</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a9203bc9><section class="VPSidebarItem level-0 collapsible" data-v-a9203bc9 data-v-6c04240e><div class="item" role="button" tabindex="0" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><h2 class="text" data-v-6c04240e>第十四章</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6c04240e><span class="vpi-chevron-right caret-icon" data-v-6c04240e></span></div></div><div class="items" data-v-6c04240e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-14/achieveKeepAlive" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>keep-alive</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a9203bc9><section class="VPSidebarItem level-0 collapsible has-active" data-v-a9203bc9 data-v-6c04240e><div class="item" role="button" tabindex="0" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><h2 class="text" data-v-6c04240e>第十五章</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6c04240e><span class="vpi-chevron-right caret-icon" data-v-6c04240e></span></div></div><div class="items" data-v-6c04240e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-15/achieveTokens" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>实现 tokens</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-15/achieveParser" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>实现 parser</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-15/parserOptimize" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>parser 优化</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-15/achieveTransformer" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>实现转换器</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/vue/chapter-15/achieveGenerator" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>实现生成器</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-02aa45e7 data-v-4b1e5151><div class="VPDoc has-sidebar has-aside" data-v-4b1e5151 data-v-feb27704><!--[--><!--]--><div class="container" data-v-feb27704><div class="aside" data-v-feb27704><div class="aside-curtain" data-v-feb27704></div><div class="aside-container" data-v-feb27704><div class="aside-content" data-v-feb27704><div class="VPDocAside" data-v-feb27704 data-v-0555e5a3><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-0555e5a3 data-v-3a01278e><div class="content" data-v-3a01278e><div class="outline-marker" data-v-3a01278e></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-3a01278e>页面导航</div><ul class="VPDocOutlineItem root" data-v-3a01278e data-v-65ce6fd8><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-0555e5a3></div><!--[--><!--]--><div class="VPDocAsideCarbonAds" data-v-0555e5a3><!----></div><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-feb27704><div class="content-container" data-v-feb27704><!--[--><!--]--><main class="main" data-v-feb27704><div style="position:relative;" class="vp-doc _record-moments_vue_chapter-15_achieveTokens" data-v-feb27704><div><p>朋友们，上节我们学习了如何实现 keep-alive，知晓了内部组件的实现方式，初步的完成了渲染器的学习，这节开始我们将进入编译器的世界，了解并学习它的实现原理。</p><p>本节的主要内容是介绍编译器和实现词法分析。</p><p>目前我们学习到的知识有：响应式实现、渲染器实现，它们都是基于处理好的 vnode 的一种技术实现方式。编译器不同，编译器是为这些实现创造基础准备的，即——生成 vnode。</p><p>编译器的实现过程有哪些准备工作：</p><ol><li>词法分析</li><li>语法分析</li><li>语义分析</li><li>中间代码生成</li><li>优化</li><li>目标代码生成</li></ol><p>总结起来就是：将源代码按照词法分析、语法分析、语义分析后生成模板ast，然后通过转换生成目标代码。其中词法分析、语法分析、语义分析称为编译前端，中间代码生成、优化、目标代码生成称为编译后端。而根据目标平台的不同，相关的技术储备和规格要求也是不同，最终要实现的目标代码也是不同。而 vue 就是一种面向 JS/JSX 实现的代码，本身涉及的代码领域较小，这种实现语言称为 DSL——特定领域语言。</p><p>通过以上介绍，我们了解了实现一门定向语言的过程与相关技术储备的要求，知晓了 vue 实现的背景。在此情况下，那就可以按照规范一步一步的去将 vue 设计的结构中的源码一步步转换为平台需要的目标代码。这其中，又因为是一门定向语言，编译后端的过程和语法规范可以适时简化。</p><p>了解了这些，我们说下这几步都是分别干什么的：</p><ol><li>词法分析：将源码转换成一组简要的节点数组，每个节点都是一个对象，包裹着对应的信息</li><li>语法分析：将词法分析的结果按照一定的规则，转换成需要的树结构，称为模板 ast</li><li>语义分析：对树结构进行语义检查，检查如标签名称是否合理、v-else 前是否有 v-if 等，进一步优化模板 ast 结构</li><li>将模板 ast 转换成平台需要的 ast，如 JS ast</li><li>对 JS ast 进行进一步的优化</li><li>生成目标代码</li></ol><p>知道了这些，我们准备一段内容模板，如下：</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">h1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;title&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;我是一级标题&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">h1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>经过 vue 的 DSL 转换之后，这段代码就变成了：</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> render</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> h</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;div&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        h</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;h1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { id: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;title&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;我是一级标题&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>这其中，<code>template</code> 包裹的内容就是源代码，而我们的目标代码就是渲染函数。</p><div class="tip custom-block"><p class="custom-block-title">注意</p><p>第二步语法分析的时候就已经生成了模板 AST 了，语义分析只是进一步的检查和优化。</p></div><p>那了解了这些，我们就要着手进行模板 AST 生成了，但是 AST 生成规则如何我们还不清楚，介绍如下：</p><ol><li>AST 树的逻辑根节点为 Root，寓意为结束标记，一切开始的地方，其 children 才为真正的根节点</li><li>元素标签的类型为 Element，名称用 tag 属性指向</li><li>标签的属性和指令存储在 props 数组中</li><li>指令节点的类型为 Directive，拥有 name 属性，指向指令名称</li><li>表达式节点类型为 Expression，拥有 content 属性，指向表达式内容</li></ol><div class="tip custom-block"><p class="custom-block-title">注意</p><p>AST 也称为抽象语法树。</p></div><p>知晓了这些，我们开始着手进行词法分析。由前面描述得知，词法分析就是将源代码拆解为一段包裹着特定信息的节点数组。那要如何去实现呢？这就要有一套规则，一套解析源代码的规则。而解析的规则早就有了统一，如浏览器平台 HTML 的解析规则。vue 遵循着这一套规则，只是因为是定向 DSL 语言，适当的进行了适合自己的调整。规则如下：</p><p><img src="/record-moments/img/48.png" alt="图片"></p><p>这个图的意思是：</p><ol><li>我们以源代码的角标为 0 的位置记录为起始状态</li><li>遇到 &lt; 进入标签开始状态</li><li>遇到 字母 进入标签名称状态</li><li>遇到 &gt; 回到起始状态，并记录标签名称</li><li>遇到 文本 进入文本状态</li><li>遇到 &lt; 进入标签开始状态，并记录文本内容</li><li>遇到 / 进入标签结束状态</li><li>遇到 字母 进入结束标签名称状态</li><li>遇到 &gt; 回到起始状态，并记录标签名称</li></ol><p>以下面源代码为例：</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;我是一段内容&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>具体步骤如下：</p><ol><li>遇到 &lt; 进入标签开始状态</li><li>遇到 字母，开始存储</li><li>遇到 &gt; 回到起始状态，存储字母为开始标签</li><li>遇到 文本，进入文本状态，开始存储</li><li>遇到 &lt;，进入标签开始状态，并存贮文本</li><li>遇到 /，进入标签结束标记</li><li>遇到 字母，开始存储</li><li>遇到 &gt;，回到其实状态，并记录结束标签</li></ol><p>最终生成的一段节点组就是：</p><ul><li>开始标签 div</li><li>文本内容 我是一段内容</li><li>结束标签 div</li></ul><p>这样的每一个节点称为 Token，意为词法记号，一组这样的节点称为 Tokens。实现如下：</p><details class="details custom-block"><summary>详细代码</summary><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> source</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `&lt;div&gt;This is a paragraph of text.&lt;/div&gt;`</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getTokens</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        origin: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 起始状态</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        startTag: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 开始标签状态</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        tagName: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 标签名称状态</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        text: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 文本状态</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        endTag: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 开始结束标签状态</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        endTagName: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 结束结束标签状态</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> tokens</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> content </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> currentStatus </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status.origin</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> isLetter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">letter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> c</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> letter.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">charCodeAt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 65</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 90</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 97</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 122</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">[\u4E00-\u9FA5]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(letter) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(letter)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> code.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // debugger</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> letter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> code[i];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (letter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;&lt;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (currentStatus </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status.text) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                tokens.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;text&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, content: content.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">join</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                content.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            currentStatus </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status.startTag</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            continue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isLetter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(letter)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            content.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(letter)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (currentStatus </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status.startTag) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                currentStatus </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status.tagName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                continue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (currentStatus </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status.origin) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                currentStatus </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status.text</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                continue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (currentStatus </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status.endTag) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                currentStatus </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status.endTagName</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                continue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (letter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;&gt;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (currentStatus </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status.tagName) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;content&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, content);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                tokens.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;startTag&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, tag: content.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">join</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                content.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                currentStatus </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status.origin</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                continue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (currentStatus </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status.endTagName) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                tokens.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;endTag&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, tag: content.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">join</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                content.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                currentStatus </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status.origin</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                continue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (letter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            currentStatus </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status.endTag</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            continue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;tokens&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, tokens);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getTokens</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(source)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br></div></div></details><p>最终会得到如下结果：</p><p><img src="/record-moments/img/47.png" alt="图片"></p><p>由结果可知，我们已经实现了如何根据源代码进行词法分析，并得到一组词法记号的功能。</p><p>至这里，我们已经完成了对词法分析的实现，知晓了其内部的实现原理——在不同的符号判断处，根据当前的状态，返回不同的词法记号，也知晓了编译器对源代码的处理过程。除此之外，知晓了何为 AST，以及其逻辑根节点和真正的子节点，与具体的规则标记等。明白了编译前端和编译后端的作用，编译前端就是对源代码进行分析，变为模板 AST；编译后端就是将模板 AST 变为目标代码。通过这些学习，我们初步的认识了编译器。下节我们将学习如何在此基础上实现一个模板 AST。</p></div></div></main><footer class="VPDocFooter" data-v-feb27704 data-v-a8c64ef9><!--[--><!--]--><div class="edit-info" data-v-a8c64ef9><div class="edit-link" data-v-a8c64ef9><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/zxn2889/record-moments/tree/main/docs/vue/chapter-15/achieveTokens.md" target="_blank" rel="noreferrer" data-v-a8c64ef9><!--[--><span class="vpi-square-pen edit-link-icon" data-v-a8c64ef9></span> 在 GitHub 上编辑此页面<!--]--></a></div><div class="last-updated" data-v-a8c64ef9><p class="VPLastUpdated" data-v-a8c64ef9 data-v-326f2cfc>最后更新于: <time datetime="2024-09-23T09:46:21.000Z" data-v-326f2cfc></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-a8c64ef9><span class="visually-hidden" id="doc-footer-aria-label" data-v-a8c64ef9>Pager</span><div class="pager" data-v-a8c64ef9><a class="VPLink link pager-link prev" href="/record-moments/vue/chapter-14/achieveKeepAlive" data-v-a8c64ef9><!--[--><span class="desc" data-v-a8c64ef9>上一页</span><span class="title" data-v-a8c64ef9>keep-alive</span><!--]--></a></div><div class="pager" data-v-a8c64ef9><a class="VPLink link pager-link next" href="/record-moments/vue/chapter-15/achieveParser" data-v-a8c64ef9><!--[--><span class="desc" data-v-a8c64ef9>下一页</span><span class="title" data-v-a8c64ef9>实现 parser</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-02aa45e7 data-v-d4bd2b03><div class="container" data-v-d4bd2b03><p class="message" data-v-d4bd2b03>基于 ISC 许可发布</p><p class="copyright" data-v-d4bd2b03>版权所有 © 2023-2024 Spade A</p></div></footer><!--[--><!--]--></div></div>
    
    
  </body>
</html>