<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>火箭吧！</title>
    <meta name="description" content="越记录，越美好！">
    <meta name="generator" content="VitePress v1.3.1">
    <link rel="preload stylesheet" href="/record-moments/assets/style.j080JL7J.css" as="style">
    <script type="module" src="/record-moments/assets/chunks/metadata.47be7af2.js"></script>
    <script type="module" src="/record-moments/assets/app.CPVhGLHT.js"></script>
    <link rel="preload" href="/record-moments/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/record-moments/assets/chunks/framework.DoOQMVQs.js">
    <link rel="modulepreload" href="/record-moments/assets/chunks/theme.C3lc9r11.js">
    <link rel="modulepreload" href="/record-moments/assets/guide_husky.md.BnGxYsPn.lean.js">
    <link rel="icon" type="image/svg+xml" href="/record-moments/img/vitepress-logo-mini.svg">
    <link rel="icon" type="image/png" href="/record-moments/img/vitepress-logo-mini.png">
    <link rel="mask-icon" color="#3eaf7c" href="/record-moments/img/vitepress-logo.svg">
    <link rel="apple-touch-icon" href="/record-moments/img/vitepress-logo.png">
    <meta name="theme-color" content="#3eaf7c">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="en">
    <meta property="og:title" content="火箭吧 | 一个记录美好生活的网站">
    <meta property="og:site_name" content="火箭吧">
    <meta property="og:image" content="https://vitepress.dev/vitepress-og.jpg">
    <meta property="og:url" content="https://vitepress.dev/">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-02aa45e7><!--[--><!--]--><!--[--><span tabindex="-1" data-v-22dc1176></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-22dc1176> Skip to content </a><!--]--><!----><header class="VPNav" data-v-02aa45e7 data-v-08088af9><div class="VPNavBar has-sidebar top" data-v-08088af9 data-v-bf18cc39><div class="wrapper" data-v-bf18cc39><div class="container" data-v-bf18cc39><div class="title" data-v-bf18cc39><div class="VPNavBarTitle has-sidebar" data-v-bf18cc39 data-v-4af299d3><a class="title" href="/record-moments/" data-v-4af299d3><!--[--><!--]--><!--[--><img class="VPImage logo" src="/record-moments/img/vitepress-logo-mini.svg" alt data-v-a00ecfd1><!--]--><span data-v-4af299d3>火箭吧！</span><!--[--><!--]--></a></div></div><div class="content" data-v-bf18cc39><div class="content-body" data-v-bf18cc39><!--[--><!--]--><div class="VPNavBarSearch search" data-v-bf18cc39><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-bf18cc39 data-v-5a389bf2><span id="main-nav-aria-label" class="visually-hidden" data-v-5a389bf2> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/record-moments/guide/husky" tabindex="0" data-v-5a389bf2 data-v-125de55a><!--[--><span data-v-125de55a>指南</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/record-moments/vue/chapter-4/proxyAchieve" tabindex="0" data-v-5a389bf2 data-v-125de55a><!--[--><span data-v-125de55a>VUE原理</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-bf18cc39 data-v-f4381c31><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="切换到深色模式" aria-checked="false" data-v-f4381c31 data-v-a5dad3f8 data-v-837a189c><span class="check" data-v-837a189c><span class="icon" data-v-837a189c><!--[--><span class="vpi-sun sun" data-v-a5dad3f8></span><span class="vpi-moon moon" data-v-a5dad3f8></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-bf18cc39 data-v-84bfe90d data-v-ee026d42><!--[--><a class="VPSocialLink no-icon" href="https://github.com/zxn2889/record-moments" aria-label="github" target="_blank" rel="noopener" data-v-ee026d42 data-v-94a69745><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-bf18cc39 data-v-b39062ce data-v-6f769cae><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-6f769cae><span class="vpi-more-horizontal icon" data-v-6f769cae></span></button><div class="menu" data-v-6f769cae><div class="VPMenu" data-v-6f769cae data-v-ac7801f7><!----><!--[--><!--[--><!----><div class="group" data-v-b39062ce><div class="item appearance" data-v-b39062ce><p class="label" data-v-b39062ce>主题</p><div class="appearance-action" data-v-b39062ce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="切换到深色模式" aria-checked="false" data-v-b39062ce data-v-a5dad3f8 data-v-837a189c><span class="check" data-v-837a189c><span class="icon" data-v-837a189c><!--[--><span class="vpi-sun sun" data-v-a5dad3f8></span><span class="vpi-moon moon" data-v-a5dad3f8></span><!--]--></span></span></button></div></div></div><div class="group" data-v-b39062ce><div class="item social-links" data-v-b39062ce><div class="VPSocialLinks social-links-list" data-v-b39062ce data-v-ee026d42><!--[--><a class="VPSocialLink no-icon" href="https://github.com/zxn2889/record-moments" aria-label="github" target="_blank" rel="noopener" data-v-ee026d42 data-v-94a69745><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-bf18cc39 data-v-63227861><span class="container" data-v-63227861><span class="top" data-v-63227861></span><span class="middle" data-v-63227861></span><span class="bottom" data-v-63227861></span></span></button></div></div></div></div><div class="divider" data-v-bf18cc39><div class="divider-line" data-v-bf18cc39></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-02aa45e7 data-v-ef70e8c8><div class="container" data-v-ef70e8c8><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-ef70e8c8><span class="vpi-align-left menu-icon" data-v-ef70e8c8></span><span class="menu-text" data-v-ef70e8c8>菜单</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-ef70e8c8 data-v-40735804><button data-v-40735804>回到顶部</button><!----></div></div></div><aside class="VPSidebar" data-v-02aa45e7 data-v-f17ec55f><div class="curtain" data-v-f17ec55f></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-f17ec55f><span class="visually-hidden" id="sidebar-aria-label" data-v-f17ec55f> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-a9203bc9><section class="VPSidebarItem level-0 collapsible has-active" data-v-a9203bc9 data-v-6c04240e><div class="item" role="button" tabindex="0" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><h2 class="text" data-v-6c04240e>指南</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6c04240e><span class="vpi-chevron-right caret-icon" data-v-6c04240e></span></div></div><div class="items" data-v-6c04240e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6c04240e data-v-6c04240e><div class="item" data-v-6c04240e><div class="indicator" data-v-6c04240e></div><a class="VPLink link link" href="/record-moments/guide/husky" data-v-6c04240e><!--[--><p class="text" data-v-6c04240e>实现 .husky</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-02aa45e7 data-v-4b1e5151><div class="VPDoc has-sidebar has-aside" data-v-4b1e5151 data-v-feb27704><!--[--><!--]--><div class="container" data-v-feb27704><div class="aside" data-v-feb27704><div class="aside-curtain" data-v-feb27704></div><div class="aside-container" data-v-feb27704><div class="aside-content" data-v-feb27704><div class="VPDocAside" data-v-feb27704 data-v-0555e5a3><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-0555e5a3 data-v-3a01278e><div class="content" data-v-3a01278e><div class="outline-marker" data-v-3a01278e></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-3a01278e>页面导航</div><ul class="VPDocOutlineItem root" data-v-3a01278e data-v-65ce6fd8><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-0555e5a3></div><!--[--><!--]--><div class="VPDocAsideCarbonAds" data-v-0555e5a3><!----></div><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-feb27704><div class="content-container" data-v-feb27704><!--[--><!--]--><main class="main" data-v-feb27704><div style="position:relative;" class="vp-doc _record-moments_guide_husky" data-v-feb27704><div><p>朋友们，之前我们学习到了很多 vue 底层的知识，今天我们来学习如何实现一个代码风格管控工具。</p><p>我们知道，团队作战比个人开发的情况要复杂的多，比如要规范团队内代码风格、提交信息规范等，如果有一套能实现风格统一的代码可以省去不少麻烦。那如何去做呢？这就是我们今天要学的 husky。</p><h4 id="如何使用-husky" tabindex="-1">如何使用 husky？ <a class="header-anchor" href="#如何使用-husky" aria-label="Permalink to &quot;如何使用 husky？&quot;">​</a></h4><p><strong>No.1</strong></p><p>首先我们要安装它，安装方式有手动安装和自动安装两种，这里我们推荐自动安装，如下：</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// npm</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">npx husky</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">init </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> npm install</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// pnpm</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pnpm dlx husky</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">init </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pnpm init</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><details class="details custom-block"><summary>注意</summary><p>如果您的编译工具不支持 <code>&amp;&amp;</code> 符号，可以使用 <code>-and</code> 代替。</p></details><p>命令成功执行后，项目的根目录下就会自动生成 <code>.husky</code> 文件夹，这就是为什么项目中会有它的来历了。然后，点开 <code>.husky</code> 文件会发现自动生成了好几个文件，我们只看 <code>pre-commit</code> 文件。</p><details class="details custom-block"><summary>注意</summary><p>自动安装方式比手动安装要方便，自动安装后会直接帮我们生成或修改好相应文件，如下：</p><ol><li>生成 <code>pre-commit</code> 文件，指在 commit 之前执行的逻辑存放入口，如：修改代码风格</li><li>修改 <code>package.json</code> 文件，增加 <code>prepare: husky inistall</code> 命令，让团队 pull 下代码后保持风格统一的方式</li></ol><p>为什么说 <code>prepare: husky inistall</code> 能保持风格统一？</p><p>因为 pkg 的命令也是有生命周期的，团队成员在执行 <code>npm install</code> 或 <code>pnpm install</code> 后，会自动执行该命令，进而生成相应文件，保持统一。</p><p><code>prepare</code> 执行顺序：<code>npm install</code>、<code>npm prepare</code>、<code>npm publish</code>。</p></details><p><strong>No.2</strong></p><p>然后我们打开 <code>pre-commit</code> 文件，会发现里面自动帮我们填充了内容 <code>npm test</code>，这个就是在我们提交 <code>commit</code> 之前要执行的命令，但是如果没有配置相关内容的话会报错，然后抛出错误警告码 1。这就需要我们在 <code>pkg.scripts</code> 里配置 <code>test</code> 脚本了，当然也有其他解决方法，如下：</p><ol><li>直接删掉 <code>npm test</code></li><li>执行 <code>--no-verify</code> 跳过校验</li><li>更新为其他脚本，如：<code>npx lint-staged</code></li></ol><p>这里我们使用第三种方案，校验代码风格并强制修改。</p><details class="details custom-block"><summary>注意</summary><p><code>lint-staged</code> 是一个能读取文件缓存区的插件。</p></details><p><strong>No.3</strong></p><p>我们开始安装 <code>lint-staged</code>，安装方式如下：</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// npm</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">npm install </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">D</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> lint</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">staged</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// pnpm</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pnpm add </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">D</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> lint</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">staged</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>安装完成后，为了不仅能读取，还能修改，我们还要安装能让代码风格保持统一的工具，有 <code>eslint、prettier</code>，这里我们选择使用 <code>eslint</code>，安装如下：</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// npm</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">npm init @eslint</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">config</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// pnpm</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pnpm create @eslint</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">config</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>执行该命令后，终端面板内会开始让我们进行一系列的选择，大家可以根据需要配置自行选择。我的如下：</p><p><img src="/record-moments/img/55.png" alt="图片"></p><p>然后我们再创建一个 eslint 忽略文件 <code>.eslintignore</code>，可根据需要自行定义内容：</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.eslintrc.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">node_modules</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dist</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/*.md</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">**/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.json</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">husky</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>然后我们再创建一个 <code>lintstagedrc.js</code> 配置文件，设置读取的内容以及如何修改：</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;src/**/*.{js, ts}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;eslint --fix&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><details class="details custom-block"><summary>注意</summary><p>创建/修改文件内容等，不要通过 <code>echo</code> 命令，其生成的内容为 <code>utf-16</code> 编码，会导致运行错误。</p></details><p>这个时候我们就可以更新 <code>pre-commit</code> 文件里的命令了，如下：</p><p><code>npx lint-staged</code></p><p>这样，在进行 commit 之前，就会执行我们的 <code>lint-staged</code> 命令，进而修改为统一格式，然后真正提交。</p><p><strong>No.4</strong></p><p>我们还可以对提交的描述信息进行风格统一，同样，我们执行命令如下：</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 一步到位</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">npx husky add .husky</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">commit</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">msg </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;npx --no -- commitlint --edit ${1}&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 分两步</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">npm pkg set scripts.commitlint</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;commitlint --edit&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">npx husky add .husky</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">commit</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">msg </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;npm run commitlint ${1}&#39;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>这样，<code>.husky</code> 文件夹下就会生成 <code>commit-msg</code> 文件，文件内容如下：</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">npx </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">no </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> commitlint </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">edit ${</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><details class="details custom-block"><summary>注意</summary><ol><li><code>npx --no</code> 表示只执行本地的依赖，找不到不去安装</li><li><code>${1}</code> 表示读取的文件名，指存储最后一次提交信息的文件 <code>.git/COMMIT_EDITMSG</code></li><li><code>commitlint --edit ${1}</code> 表示从文件里读取内容进行校验</li></ol></details><p>然后，我们再安装相关依赖如下：</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// npm</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">npm install </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">save</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dev @commitlint</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">conventional @commitlint</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cli</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// pnpm</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pnpm add </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">D</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @commitlint</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">conventional @commitlint</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cli</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>至这里，其实我们的 <code>commitlint</code> 就体现作用了，只不过，在提交信息时会提示我们创建一个 <code>commitlint.config.js</code> 配置文件，该文件存储的是我们对描述信息的校验规则，如下：</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    entends: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;@commitlint/config-conventional&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rules: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;type-case&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;always&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;lowerCase&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// enum 类型为小写</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;type-empty&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;never&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 类型不能为空</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;subject-case&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;never&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 内容以空格间隔时写法，范围-英文</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;subject-empty&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;never&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 内容不允许有空格</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;subject-full-stop&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;never&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;.&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 匹配到描述内容的结尾符号报错</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;header-max-length&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;never&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 首行文本长度不能超过多少</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;type-enum&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;always&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;build&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;chore&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ci&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;docs&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;feat&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;fix&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;perf&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;refactor&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;revert&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;style&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;test&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><details class="details custom-block"><summary>注意</summary><p>这里的 <code>rules</code> 是一定要配置的，各个值也一定要是有效的命令，每个命令值为数组形式，接收多个参数（至多3个），每个位置的参数表示的含义不同：</p><ol><li>第一顺位参数值为 0 | 1 | 2，分别表示：禁用规则 | 警告 | 报错</li><li>第二顺位参数值为 <code>always</code> | <code>never</code>，<code>never</code> 表示颠倒规则</li><li>第三顺位参数为值，可不传</li></ol></details><p>这样，我们就完成了我们所有的配置工作，至此，我们的代码风格和提交描述信息等就都有了明确的规范，团队效率将会有很大的提高。</p></div></div></main><footer class="VPDocFooter" data-v-feb27704 data-v-a8c64ef9><!--[--><!--]--><div class="edit-info" data-v-a8c64ef9><div class="edit-link" data-v-a8c64ef9><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/zxn2889/record-moments/tree/main/docs/guide/husky.md" target="_blank" rel="noreferrer" data-v-a8c64ef9><!--[--><span class="vpi-square-pen edit-link-icon" data-v-a8c64ef9></span> 在 GitHub 上编辑此页面<!--]--></a></div><div class="last-updated" data-v-a8c64ef9><p class="VPLastUpdated" data-v-a8c64ef9 data-v-326f2cfc>最后更新于: <time datetime="2024-09-23T07:27:38.000Z" data-v-326f2cfc></time></p></div></div><!----></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-02aa45e7 data-v-d4bd2b03><div class="container" data-v-d4bd2b03><p class="message" data-v-d4bd2b03>基于 ISC 许可发布</p><p class="copyright" data-v-d4bd2b03>版权所有 © 2023-2024 Spade A</p></div></footer><!--[--><!--]--></div></div>
    
    
  </body>
</html>